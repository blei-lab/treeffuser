<!--
  Copyright 2018 The Distill Template Authors

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<!doctype html>

<head>
  <script src="template.v2.js"></script>
  <script src="https://d3js.org/d3.v5.min.js"></script>


  <link rel="stylesheet" type="text/css" href="css/base.css">
  <link rel="stylesheet" type="text/css" href="css/layout.css">
  <link rel="stylesheet" type="text/css" href="css/title.css">
  <link rel="stylesheet" type="text/css" href="css/header.css">
  <link rel="stylesheet" type="text/css" href="css/treeffuser.css">
  <link rel="stylesheet" type="text/css" href="css/feature-table.css">
  <link rel="stylesheet" type="text/css" href="css/code.css">
  <link rel="stylesheet" type="text/css" href="css/flex-list.css">
  <link rel="stylesheet" type="text/css" href="css/example-cards.css">
  <link rel="stylesheet" type="text/css" href="css/tabs.css">
  <link rel="stylesheet" type="text/css" href="css/pretty-buttons.css">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="https://unpkg.com/flickity@2/dist/flickity.min.css">



  <!--
    Dep
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  -->

  <style>
  </style>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf8">
<!--<script src="https://kit.fontawesome.com/18ddf7cd34.js" crossorigin="anonymous"></script>-->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
</head>


<body class="l-page">
  <distill-header>
  <div class="content">
    <a href="/treeffuser" class="logo">
      <svg id="Layer_2" data-name="Layer 2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 127.63 158.74">
  <defs>
    <style>
      .cls-1 {
        fill: none;
        stroke: #fff;
        stroke-miterlimit: 10;
      }
    </style>
  </defs>
  <g id="Layer_1-2" data-name="Layer 1">
    <path class="cls-1" d="M46.51,100.89C18.84,98.94.91,82.79.52,79.59c-.65-5.31,19.94-7.34,20.64-17.36.57-8.04-13.66-12.49-12.84-21.68.74-8.33,14.14-8.9,24.55-14.11S41.81.5,54.71.5c19.17,0,11.14,18.33,24.79,26.09,2.96,1.68,5.88,1.76,7.82,1.88,12.53.81,16.24-4.22,19.73-2.03,5.1,3.2-9.65,23.03-1.94,31.23,5.11,5.44,20.89-2.19,21.96,1.42,1.28,4.33-16.33,33.1-41.01,43.85"/>
    <path class="cls-1" d="M55.85,158.24h15.94c9.35,0,2.41-71.57.47-90.04-.26-2.45-2.33-4.31-4.79-4.31h-7.91c-2.12,0-3.91,1.58-4.16,3.68-2.1,17.41-10.31,90.66.46,90.66Z"/>
    <line class="cls-1" x1="25.65" y1="81.03" x2="53.01" y2="84.72"/>
    <line class="cls-1" x1="44.53" y1="83.57" x2="29.17" y2="46.04"/>
    <line class="cls-1" x1="63.82" y1="63.89" x2="55.85" y2="19.97"/>
    <line class="cls-1" x1="71.79" y1="66.57" x2="93.26" y2="40.87"/>
    <line class="cls-1" x1="73.53" y1="84.72" x2="105.74" y2="71.7"/>
  </g>
</svg>
<!--      <svg width="200" height="200" xmlns="http://www.w3.org/2000/svg">-->
<!--  <path d="M100 200 L90 140 Q60 100 50 60 Q70 70 85 50 Q100 60 115 50 Q130 70 150 60 Q140 100 110 140 Z" />-->
<!--</svg>-->
      Treeffuser
    </a>
    <nav class="nav">
      <a href="/documentation/">Docs </a>
      <a href="https://github.com/blei-lab/treeffuser">Github</a>
      <a href="https://arxiv.org/abs/2406.07658">Paper</a>
    </nav>
  </div>
  </distill-header>
  <!-- "authorURL":"https://colah.github.io/", -->
  <d-front-matter>
    <script id='distill-front-matter' type="text/json">{
    "title": "Treeffuser: Probabilistic Predictions with Conditional Diffusions and Gradient Boosted Trees",
    "description": "Although \" extremely useful for visualizing high-dimensional data, t-SNE plots can sometimes be mysterious or misleading.",
    "published": "May 23, 2024",
    "authors": [
      {
        "author":"Nicolas Beltran*",
        "affiliations": [{"name": "Columbia University"}]
      },
      {
        "author":"Alessandro Grande*",
        "affiliations": [{"name": "Columbia University"}]
      },
      {
        "author":"Achille Nazaret*",
        "affiliations": [{"name": "Columbia University"}]
      }
      ,
      {
        "author":"Alp Kucukelbir",
        "affiliations": [
          {"name": "Fero Labs"}
        ]
    },
    {
      "author":"David Blei",
        "affiliations": [
         {"name": "Columbia University"}
      ]

    }
    ],
    "doi": "2406.07658",
    "katex": {
      "delimiters": [
        {"left": "$$", "right": "$$", "display": false}
      ]
    }
  }</script>
  </d-front-matter>


  <d-title class="l-page">
    <!--
    <figure style="grid-column: page; margin: 1rem 0;"><img src="momentum.png"
        style="width:100%; border: 1px solid rgba(0, 0, 0, 0.2);" /></figure>
    <p>We often think of Momentum<d-cite key="mercier2011humans"></d-cite> as a means of dampening oscillations and
      speeding up the iterations, leading to faster convergence. But it has other interesting behavior. It allows a
      larger range of step-sizes to be used, and creates its own oscillations. What is going on?</p>
    -->
    <p>
      Probabilistic predictions provide predictive distributions rather than single point predictions.
      This is important to quantify uncertainty, compute risk, and detect outliers. Treeffuser is a new method for
      probabilistic predictions. It is fast, super-flexible, and easy to use.

    </p>
    <figure class="teaser">
      <div id="figure1">
      </div>
      <script src="js/figure1.js"></script>
      <figcaption>Treeffuser</figcaption>
    </figure>
  </d-title>

  <d-byline></d-byline>



  <d-article>
    <h2>Probabilistic Predictions</h2>
    <p>
      A standard task in many fields is to predict a target variable <d-math>y</d-math> given some input <d-math>x</d-math>.
      Many algorithms provide point estimates, a single value of <d-math>y</d-math> for each <d-math>x</d-math>.
      However, for most real world applications it is important to not only have a point estimate, our best guess for <d-math>y</d-math>,
      but also a measure of uncertainty associated with that estimate.
      A natural way to quantify uncertainty is to provide a probability distribution
      <d-math> p(y|x) </d-math>over <d-math>y</d-math> given <d-math>x</d-math>.
    </p>

    <p>We can then use this distribution to compute</p>
    <ul class="flex-list">
      <li>The expected value of <d-math>y</d-math>, <d-math>\mathbb{E}[y|x]</d-math>,</li>
      <li>The variance of <d-math>y</d-math>, <d-math>\text{Var}[y|x]</d-math>,</li>
      <li>The probability that <d-math>y</d-math> is greater than some threshold,</li>
      <li>The probability that <d-math>y</d-math> is in some interval,</li>
    </ul>
    <p>and many other quantities!</p>
    <div class="fake-img">
    </div>



    <p>
      The main difficulty is that in practice we don't have access to <d-math>p(y|x)</d-math>
      but only to a dataset of samples from this distribution.
      How does one go about estimating <d-math>p(y|x)</d-math> from a dataset?
    </p>



    <h2>Treeffuser</h2>

    <p>
      Treeffuser is a new method for producing such probabilistic predictions.
      It is estimates <d-math>p(y|x)</d-math> by combining two powerful techniques:
    </p>

    <ol>
      <li>
        <b> Conditional diffusions: </b> This gives Treeffuser the ability to model essentially
        any distribution <d-math>p(y|x)</d-math> without requiring special assumptions from
        the user.
      </li>
      <li>
        <b>
          Gradient boosted trees:
        </b>
        This makes Treeffuser fast, easy to use and well suited for tabular data problems,
        the most common type of data in the real world.
      </li>
    </ol>
    <p>
      These two techniques combined make treeffuser and extremely powerful tool for probabilistic predictions.
    </p>




    <div class="feature-table">
      <!-- Example of a feature item -->
      <div class="feature-item">
        <div class="feature-header">
          <h4>Extreme flexibility</h4>
        </div>
        <div class="feature-body">
          <p>
            Due to the use of conditional diffusions Treeffuser
            can model, heavy tailed, multimodal, skewed
            and other complex distributions.
          </p>
        </div>
      </div>
      <div class="feature-item">
      <div class="feature-header">
        <h4>Robustness to misspecification</h4>
      </div>
      <div class="feature-body">
        <p>
          Treeffuser doesn't require any special configuration to
          work with any distribution <d-math>p(y|x)</d-math>.
          It fully adapts to the data avoiding the need for
          assumptions that may not hold in practice.
        </p>
      </div>
    </div>

    <div class="feature-item">
      <div class="feature-header">
        <h4>Easy to use</h4>
      </div>
      <div class="feature-body">
        <p>
          Treeffuser adopts the same API as <code>sklearn</code>
          and using it is a simple as calling <code>model.fit(X,y)</code>
          and <code>model.sample(X)</code>.
        </p>
      </div>
    </div>

    <div class="feature-item">
      <div class="feature-header">
        <h4>Designed for tabular data</h4>
      </div>
      <div class="feature-body">
    <p>
      Treeffuser is built on top <code>LightGBM</code>,
      a fast and efficient implementation of gradient boosted trees
      has state of the art performance on tabular data problems.
    </p>
  </div>
</div>

<div class="feature-item">
  <div class="feature-header">
    <h4>Multivariate output</h4>
  </div>
  <div class="feature-body">
    <p>
      Treeffuser supports multivariate output <d-math> y</d-math>, allowing for the
      modelling of complex correlations between multiple output variables.
    </p>
  </div>
</div>

<div class="feature-item">
  <div class="feature-header">
    <h4>Support for missing data and categorical values</h4>
  </div>
  <div class="feature-body">
    <p>
      Treeffuser natively implements
      principled methods for handling missing data
      at training and inference time, making it easy to use in practice
      and robust to real world data.
    </p>
  </div>
</div>
      <!-- Additional feature items would follow the same pattern -->
    </div>


    <h3> Competitive performance</h3>
    Treeffuser has state of the art performance on a variety of benchmarks.
    And is competitive with other state of the art methods for probabilistic predictions.
    <div class ="tab-container">
      <div class="tab">
        <button class="tablinks" onclick="openTab(event, 'CRPS')">Continuous Ranked Probability Score</button>
        <button class="tablinks" onclick="openTab(event, 'RMSE')">Root Mean Squared Error</button>
        <button class="tablinks" onclick="openTab(event, 'MACE')">Mean Absolute Calibration Error</button>
      </div>

      <div id="CRPS" class="tabcontent">

        <h3>CRPS (lower is better) by dataset and method</h3>
          <table>
            <tr>
              <th>dataset</th>
              <th>N, d<sub>x</sub>, d<sub>y</sub></th>
              <th>Deep ensembles</th>
              <th>NGBost (Gaussian)</th>
              <th>iBUG (XGBoost)</th>
              <th>Quantile regression</th>
              <th>DRF</th>
              <th>Treefuser</th>
              <th>Treefuser (no tuning)</th>
            </tr>
            <tr>
              <td>bike</td>
              <td>17379,12,1</td>
              <td class="highlight">1.61±0.05</td>
              <td>7.15±0.18</td>
              <td>2.21±0.04</td>
              <td>1.85±0.07</td>
              <td>2.15±0.06</td>
              <td>1.60±0.05</td>
              <td>1.64±0.05</td>
            </tr>
            <tr>
              <td>energy</td>
              <td>768, 8, 2</td>
              <td>5.00±0.71</td>
              <td>4.78±0.49</td>
              <td>NA</td>
              <td>NA</td>
              <td>5.43±0.69</td>
              <td class="highlight">3.07±0.40</td>
              <td>3.32±0.48</td>
            </tr>
            <tr>
              <td>kin8nm</td>
              <td>8192, 8, 1</td>
              <td class="highlight">3.59±0.12</td>
              <td>9.48±0.29</td>
              <td>7.14±0.18</td>
              <td>6.63±0.16</td>
              <td>9.44±0.20</td>
              <td>5.89±0.14</td>
              <td>5.88±0.17</td>
            </tr>
            <tr>
              <td>movies</td>
              <td>7415, 9, 1</td>
              <td class="highlight">2.94±0.35</td>
              <td>X</td>
              <td>3.18±0.29</td>
              <td>7.90±0.68</td>
              <td>5.57±0.61</td>
              <td>2.68±0.31</td>
              <td>2.69±0.28</td>
            </tr>
            <tr>
              <td>naval</td>
              <td>11934,17,1</td>
              <td>4.11±0.39</td>
              <td>4.43±0.19</td>
              <td>4.70±0.16</td>
              <td>16.86±2.46</td>
              <td>4.55±0.16</td>
              <td class="highlight">2.02±0.08</td>
              <td>2.46±0.07</td>
            </tr>
            <tr>
              <td>news</td>
              <td>39644,58,1</td>
              <td>2.53±0.27</td>
              <td>X</td>
              <td>3.75±0.43</td>
              <td>2.32±0.17</td>
              <td>1.98±0.17</td>
              <td class="highlight">1.98±0.17</td>
              <td>1.98±0.16</td>
            </tr>
            <tr>
              <td>power</td>
              <td>9568, 4, 1</td>
              <td>2.06±0.10</td>
              <td>2.01±0.13</td>
              <td>1.71±0.09</td>
              <td>5.40±0.12</td>
              <td>1.90±0.11</td>
              <td class="highlight">1.49±0.07</td>
              <td>1.52±0.07</td>
            </tr>
            <tr>
              <td>super.</td>
              <td>21263,81,1</td>
              <td>4.89±0.31</td>
              <td>5.24±0.50</td>
              <td>4.43±0.24</td>
              <td>3.79±0.14</td>
              <td>4.32±0.52</td>
              <td class="highlight">3.52±0.13</td>
              <td>3.60±0.15</td>
            </tr>
            <tr>
              <td>wine</td>
              <td>6497, 12, 1</td>
              <td class="highlight">3.59±0.10</td>
              <td>3.82±0.11</td>
              <td>3.47±0.13</td>
              <td>3.24±0.14</td>
              <td>3.30±0.12</td>
              <td>2.59±0.13</td>
              <td>2.67±0.13</td>
            </tr>
            <tr>
              <td>yacht</td>
              <td>308, 6, 1</td>
              <td>4.86±1.38</td>
              <td>3.67±1.47</td>
              <td>3.17±1.13</td>
              <td>3.53±1.30</td>
            <td>7.73±2.43</td>
            <td>3.11±0.99</td>
            <td class="highlight">3.39±0.97</td>
            </tr>
          </table>

          <p>CRPS (lower is better) by dataset and method. X indicates the method failed to run, and NA that the method is not directly applicable to multivariate outputs. Standard deviations are measured with 10-fold cross-validation. For each dataset, the two best methods are bolded. Treefuser provides the most accurate probabilistic predictions, even with default hyper-parameters (no tuning).</p>
      </div>

      <div id="RMSE" class="tabcontent">
        <h3>RMSE (lower is better) by dataset and method</h3>
        <table>
          <tr>
            <th>dataset</th>
            <th>N, d<sub>x</sub>, d<sub>y</sub></th>
            <th>Deep ensembles</th>
            <th>NGBost (Gaussian)</th>
            <th>iBUG (XGBoost)</th>
            <th>Quantile regression</th>
            <th>DRF</th>
            <th>Treefuser</th>
            <th>Treefuser (no tuning)</th>
          </tr>
          <tr>
            <td>bike</td>
            <td>17379,12,1</td>
            <td>3.70±0.13</td>
            <td>11.52±0.30</td>
            <td>4.16±0.10</td>
            <td>4.63±0.21</td>
            <td>4.86±0.18</td>
            <td class="highlight">3.69±0.14</td>
            <td>3.81±0.15</td>
          </tr>
          <tr>
            <td>energy</td>
            <td>768, 8, 2</td>
            <td>11.34±0.28</td>
            <td>11.41±0.25</td>
            <td>NA</td>
            <td>NA</td>
            <td>13.73±1.69</td>
            <td class="highlight">8.32±1.35</td>
            <td>8.79±1.46</td>
          </tr>
          <tr>
            <td>kin8nm</td>
            <td>8192, 8, 1</td>
            <td class="highlight">0.64±0.02</td>
            <td>1.71±0.06</td>
            <td>1.94±0.06</td>
            <td>1.23±0.14</td>
            <td>1.18±0.04</td>
            <td>1.06±0.03</td>
            <td>1.06±0.02</td>
          </tr>
          <tr>
            <td>movies</td>
            <td>7415, 9, 1</td>
            <td>5.75±1.38</td>
            <td>X</td>
            <td>4.87±0.80</td>
            <td>49.93±0.07</td>
            <td>1.31±0.47</td>
            <td class="highlight">2.71±1.36</td>
            <td>5.17±1.32</td>
          </tr>
          <tr>
            <td>naval</td>
            <td>11934,17,1</td>
            <td>13.31±1.90</td>
            <td>5.50±0.75</td>
            <td>4.10±0.58</td>
            <td>15.05±0.58</td>
            <td>17.37±0.40</td>
            <td class="highlight">7.75±0.41</td>
            <td>9.10±0.39</td>
          </tr>
          <tr>
            <td>news</td>
            <td>39644,58,1</td>
            <td>1.95±2.66</td>
            <td>X</td>
            <td>1.21±0.37</td>
            <td>1.12±0.40</td>
            <td>1.08±0.41</td>
            <td class="highlight">1.10±0.40</td>
            <td>1.09±0.41</td>
          </tr>
          <tr>
            <td>power</td>
            <td>9568, 4, 1</td>
            <td>3.11±0.32</td>
            <td>3.66±0.35</td>
            <td>3.16±0.53</td>
            <td>9.36±0.58</td>
            <td>3.65±0.35</td>
            <td class="highlight">2.93±0.30</td>
            <td>3.02±0.30</td>
          </tr>
          <tr>
            <td>super.</td>
            <td>21263,81,1</td>
            <td>11.28±0.74</td>
            <td>11.25±0.87</td>
            <td>9.53±0.32</td>
            <td>9.06±0.58</td>
            <td>3.87±0.56</td>
            <td class="highlight">3.50±0.70</td>
            <td>4.87±0.28</td>
          </tr>
          <tr>
            <td>wine</td>
            <td>6497, 12, 1</td>
            <td>1.56±0.17</td>
            <td>6.85±0.18</td>
            <td>6.83±0.28</td>
            <td>6.30±0.28</td>
            <td>8.24±0.21</td>
            <td class="highlight">5.88±0.17</td>
            <td>5.98±0.15</td>
          </tr>
          <tr>
            <td>yacht</td>
            <td>308, 6, 1</td>
            <td>1.06±0.46</td>
            <td>0.85±0.13</td>
            <td>0.67±0.26</td>
            <td>1.28±0.79</td>
            <td>6.34±0.01</td>
            <td class="highlight">2.01±0.08</td>
            <td>2.08±0.09</td>
          </tr>
        </table>
        <p>RMSE (lower is better) by dataset and method. X indicates the method failed to run, and NA that the method is not directly applicable to multivariate outputs. Standard deviations are measured with 10-fold cross-validation. For each dataset, the two best methods are bolded. Treefuser provides the most accurate probabilistic predictions, even with default hyper-parameters (no tuning).</p>
      </div>

      <div id="MACE" class="tabcontent">
        <h3>MACE (lower is better) by dataset and method</h3>
        <table>
          <tr>
            <th>dataset</th>
            <th>N, d<sub>x</sub>, d<sub>y</sub></th>
            <th>Deep ensembles</th>
            <th>NGBost (Gaussian)</th>
            <th>iBUG (XGBoost)</th>
            <th>Quantile regression</th>
            <th>DRF</th>
            <th>Treefuser</th>
            <th>Treefuser (no tuning)</th>
          </tr>
          <tr>
            <td>bike</td>
            <td>17379,12,1</td>
            <td>2.38±0.97</td>
            <td>17.79±0.68</td>
            <td>7.68±0.89</td>
            <td>2.95±0.29</td>
            <td>3.45±0.43</td>
            <td class="highlight">1.73±0.62</td>
            <td>1.86±0.87</td>
          </tr>
          <tr>
            <td>energy</td>
            <td>768, 8, 2</td>
            <td>8.08±1.41</td>
            <td>5.82±1.74</td>
            <td>NA</td>
            <td>NA</td>
            <td>4.54±0.74</td>
            <td class="highlight">3.11±1.14</td>
            <td>5.33±1.42</td>
          </tr>
          <tr>
            <td>kin8nm</td>
            <td>8192, 8, 1</td>
            <td>2.51±0.50</td>
            <td>2.75±0.11</td>
            <td>3.83±1.56</td>
            <td>4.74±0.93</td>
            <td>3.87±0.56</td>
            <td class="highlight">1.36±1.31</td>
            <td>1.77±0.74</td>
          </tr>
          <tr>
            <td>movies</td>
            <td>7415, 9, 1</td>
            <td>19.26±1.13</td>
            <td>X</td>
            <td>4.73±1.65</td>
            <td>4.57±0.94</td>
            <td>2.87±0.52</td>
            <td class="highlight">1.34±0.31</td>
            <td>1.33±0.16</td>
          </tr>
          <tr>
            <td>naval</td>
            <td>11934,17,1</td>
            <td>5.29±1.68</td>
            <td>2.53±0.00</td>
            <td>3.78±1.56</td>
            <td>4.75±0.43</td>
            <td>3.87±0.56</td>
            <td class="highlight">1.44±1.30</td>
            <td>1.73±0.14</td>
          </tr>
          <tr>
            <td>news</td>
            <td>39644,58,1</td>
            <td>21.53±0.63</td>
            <td>X</td>
            <td>13.57±1.40</td>
            <td>18.96±0.42</td>
            <td>1.14±0.25</td>
            <td class="highlight">3.50±0.70</td>
            <td>4.87±0.28</td>
          </tr>
          <tr>
            <td>power</td>
            <td>9568, 4, 1</td>
            <td>2.52±1.18</td>
            <td>2.53±1.00</td>
            <td>3.83±1.65</td>
            <td>4.75±0.93</td>
            <td>2.87±0.56</td>
            <td class="highlight">1.36±1.31</td>
            <td>1.77±0.74</td>
          </tr>
          <tr>
            <td>super.</td>
            <td>21263,81,1</td>
            <td>3.19±0.13</td>
            <td>2.68±0.15</td>
            <td>3.45±0.77</td>
            <td>4.86±0.90</td>
            <td>22.02±1.13</td>
            <td class="highlight">5.70±0.55</td>
            <td>5.22±0.69</td>
          </tr>
          <tr>
            <td>wine</td>
            <td>6497, 12, 1</td>
            <td>13.25±0.57</td>
            <td>9.28±0.25</td>
            <td>8.45±0.20</td>
            <td>6.28±0.29</td>
            <td>8.34±0.21</td>
            <td class="highlight">2.01±0.08</td>
            <td>2.08±0.09</td>
          </tr>
          <tr>
            <td>yacht</td>
            <td>308, 6, 1</td>
            <td>3.19±0.56</td>
            <td>2.68±0.15</td>
            <td>3.45±0.77</td>
            <td>4.86±0.90</td>
            <td>22.02±1.13</td>
            <td class="highlight">5.70±0.55</td>
            <td>5.22±0.69</td>
          </tr>
        </table>

        <p>MACE (lower is better) by dataset and method. X indicates the method failed to run, and NA that the method is not directly applicable to multivariate outputs. Standard deviations are measured with 10-fold cross-validation. For each dataset, the two best methods are bolded. Treefuser has a competitive calibration error across most datasets.</p>

      </div>
    </div>

    <h3> Usage Examples </h3>

      <div class="cards-container">
        <a href="https://arxiv.org/pdf/2406.07658" class="example-card">
          <img src="imgs/img_avatar.png" alt="Avatar">
          <div class="example-container">
            <h4><b> Optimal Inventory Allocation</b></h4>
            <p>
              We use Treeffuser to model the distribution of demand for products
              in a retail store. This allows us to compute the optimal inventory
              allocation that minimizes the risk of stockouts and waste while maximizing
              profits.
            </p>

          </div>
        </a>
        <a href="https://arxiv.org/pdf/2406.07658" class="example-card">
          <img src="imgs/img_avatar.png" alt="Avatar">
          <div class="example-container">
            <h4><b> Synthetic Data </b></h4>
            <p>
              We demonstrate the effectiveness and flexibility of Treeffuser
              of treeffuser on Synthetic data with multivariate output,
              complex varying multimodality, heavy tails and skewness.
            </p>
          </div>
        </a>

        <a href="https://arxiv.org/pdf/2406.07658" class="example-card">
          <img src="imgs/img_avatar.png" alt="Avatar">
          <div class="example-container">
            <h4><b>Some other example</b></h4>
            <p>
              Lorem ipsum dolor sit amet, consectetur adipiscing
              elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
            </p>
          </div>
        </a>
    </div>



    <h2>Next steps</h2>
    <p>
      Installing and using Treeffuser is easy and simple.
      Our package is available on PyPI and can be installed with pip.
    </p>

    <pre><code class="language-python">pip install treeffuser</code></pre>

    <p>
      We adhere to the scikit-learn API,
      so you can use Treeffuser as you would any other scikit-learn model.
    </p>
    <div>
    <pre><code class="language-python">from treeffuser import Treeffuser
# Load some data
X_train, X_test, y_train, y_test = ...

model = Treeffuser()
model.fit(X_train, y_train)
samples = model.sample(X_test)

y_samples = model.sample(x, n_samples=100, verbose=True) # y_samples.shape[0] is 100

# Estimate downstream quantities of interest
y_mean = y_samples.mean(axis=0) # conditional mean for each x
y_std = y_samples.std(axis=0) # conditional std for each x</code></pre>
    </div>
    <p>
      We hope you enjoy using Treeffuser!
      Please check out the paper, the documentation, and the code on GitHub
      for more information.
    </p>

    <div class="button-container">
      <a href="https://github.com/blei-lab/treeffuser" class="button-6">
          <i class="fas fa-book"></i> Docs
      </a>

      <a href="https://arxiv.org/pdf/2406.07658" class="button-6">
          <i class="fas fa-file-alt"></i> Paper
      </a>

      <a href="https://github.com/blei-lab/treeffuser" class="button-6">
          <i class="fab fa-github"></i> GitHub
      </a>
  </div>



    <!--
    <a class="marker" href="#section-1" id="section-1"><span>1</span></a>
    <h2>A Brief Survey of Techniques</h2>

    <p>Before diving in: if you haven’t encountered t-SNE before, here’s what you need to know about the math behind it.
      The goal is to take a set of points in a high-dimensional space and find a faithful representation of those points
      in a lower-dimensional space, typically the 2D plane. The algorithm is non-linear and adapts to the underlying
      data, performing different transformations on different regions. Those differences can be a major source of
      confusion.</p>
    <p>This is the first paragraph of the article. Test a long&thinsp;&mdash;&thinsp;dash -- here it is.</p>
    <p>Test for owner's possessive. Test for "quoting a passage." And another sentence. Or two. Some flopping fins; for
      diving.</p>
    <aside>Some text in an aside, margin notes, etc...</aside>
    <p>Here's a test of an inline equation <d-math>c = a^2 + b^2</d-math>. Also with configurable katex standards just
      using inline '$' signs: $$x^2$$ And then there's a block equation:</p>
    <d-math block>
      c = \pm \sqrt{ \sum_{i=0}^{n}{a^{222} + b^2}}
    </d-math>
    <p>Math can also be quite involved:</p>
    <d-math block>
      \frac{1}{\Bigl(\sqrt{\phi \sqrt{5}}-\phi\Bigr) e^{\frac25 \pi}} = 1+\frac{e^{-2\pi}} {1+\frac{e^{-4\pi}}
      {1+\frac{e^{-6\pi}} {1+\frac{e^{-8\pi}} {1+\cdots} } } }
    </d-math>
    <a class="marker" href="#section-1.1" id="section-1.1"><span>1.1</span></a>
    <h3>Citations</h3>
    <p>
      <d-slider style="width: 200px;"></d-slider>
    </p>
    <p>We can<d-cite bibtex-key="mercier2011humans"></d-cite> also cite <d-cite
        key="gregor2015draw,mercier2011humans,openai2018charter"></d-cite> external publications. <d-cite
        key="dong2014image,dumoulin2016guide,mordvintsev2015inceptionism"></d-cite>. We should also be testing footnotes
      <d-footnote>This will become a hoverable footnote. This will become a hoverable footnote. This will become a
        hoverable footnote. This will become a hoverable footnote. This will become a hoverable footnote. This will
        become a hoverable footnote. This will become a hoverable footnote. This will become a hoverable footnote.
      </d-footnote>. There are multiple footnotes, and they appear in the appendix<d-footnote>Given I have coded them
        right. Also, here's math in a footnote: <d-math>c = \sum_0^i{x}</d-math>. Also, a citation. Box-ception<d-cite
          key='gregor2015draw'></d-cite>!</d-footnote> as well.</p>
    <a class="marker" href="#section-2" id="section-2"><span>2</span></a>
    <h2>Displaying code snippets</h2>
    <p>Some inline javascript:<d-code language="javascript">var x = 25;</d-code>. And here's a javascript code block.
    </p>
    <d-code block language="javascript">
      var x = 25;
      function(x){
      return x * x;
      }
    </d-code>
    <p>We also support python.</p>
    <d-code block language="python">
      # Python 3: Fibonacci series up to n
      def fib(n):
      a, b = 0, 1
      while a < n: print(a, end=' ' ) a, b=b, a+b </d-code>
        <p>And a table</p>
        <table>
          <thead>
            <tr>
              <th>First</th>
              <th>Second</th>
              <th>Third</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>23</td>
              <td>654</td>
              <td>23</td>
            </tr>
            <tr>
              <td>14</td>
              <td>54</td>
              <td>34</td>
            </tr>
            <tr>
              <td>234</td>
              <td>54</td>
              <td>23</td>
            </tr>
          </tbody>
        </table>
        <d-figure id="last-figure"></d-figure>
        <script>
          const figure = document.querySelector("d-figure#last-figure");
          const initTag = document.createElement("span");
          initTag.textContent = "initialized!"
          figure.appendChild(initTag);
          figure.addEventListener("ready", function () {
            const initTag = figure.querySelector("span");
            initTag.textContent = "ready"
            console.log('ready')
          });
          figure.addEventListener("onscreen", function () {
            const initTag = figure.querySelector("span");
            initTag.textContent = "onscreen"
            console.log('onscreen')
          });
          figure.addEventListener("offscreen", function () {
            const initTag = figure.querySelector("span");
            initTag.textContent = "offscreen!"
            console.log('offscreen')
          });
        </script>
        <p>That's it for the example article!</p>
    -->

  </d-article>




  <d-appendix>

    <h3>Contributions</h3>
    <p>Some text describing who did what.</p>
    <h3>Reviewers</h3>
    <p>Some text with links describing who reviewed the article.</p>

    <d-bibliography src="bibliography.bib"></d-bibliography>
  </d-appendix>

  <distill-footer></distill-footer>






  <!-- and it's easy to individually load additional languages -->
  <script src="js/tabs.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/python3.min.js"></script>
  <script>hljs.highlightAll();</script>


  <!-- Deps
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  -->
</body>
